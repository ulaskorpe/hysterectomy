{"version":3,"file":"js/3862.js","mappings":"4cAKA,E,uGCqGA,IAOMA,GAAUC,EAAAA,EAAAA,MAAI,GACdC,GAAgBD,EAAAA,EAAAA,MAAI,GACpBE,GAAiBF,EAAAA,EAAAA,MAAI,GACrBG,GAAkBH,EAAAA,EAAAA,MAAI,GACtBI,GAAeJ,EAAAA,EAAAA,MAAI,GACnBK,GAAcL,EAAAA,EAAAA,KAAI,IAClBM,GAAWN,EAAAA,EAAAA,KAAI,IAEfO,GAAUC,EAAAA,EAAAA,KAEVC,EAAY,WACdV,EAAQW,OAAQ,EAChBP,EAAgBO,OAAQ,EACxBR,EAAeQ,OAAQ,EACvBN,EAAaM,OAAQ,EACrBJ,EAASI,MAAQ,GACjBL,EAAYK,MAAQ,EACxB,EAEMC,GAAYC,EAAAA,EAAAA,IAAQ,CACtBC,UAAU,GACVC,WAAW,KAGTC,GAAkBH,EAAAA,EAAAA,IAAQ,CAC5BC,UAAU,KAGRG,EAAW,SAACC,GACd,MAAO,CAAC,CAAE,wBAA2C,IAAnBA,EAAKC,WAC3C,EAEMC,EAAkB,WAEpBpB,EAAQW,OAAQ,EAChBK,EAAgBF,UAAY,GAE5BO,MAAMC,MAAM,4BAA4B,CACpCC,OAAQ,OACRC,QAAS,CACL,OAAU,mBACV,eAAgB,mBAChB,gBAAgBC,EAAAA,EAAAA,MAAUC,MAAMC,YAEpCC,KAAMC,KAAKC,UAAU,CACjBhB,UAAUF,EAAUE,UACpBC,WAAWH,EAAUG,eAE1BgB,MAAK,SAAUC,GACd,OAAOA,EAASC,MACpB,IAAGF,MAAK,SAACE,GACLjC,EAAQW,OAAQ,EACVsB,EAAKC,SAIXlB,EAAgBF,UAAYmB,EAAKE,aACjChC,EAAeQ,OAAQ,GAJnByB,MAAMH,EAAKI,QAKnB,GAEJ,EAEMC,EAA6B,WAE/B9B,EAAQ+B,QAAQ,CACZF,QAAS,wEACTG,OAAQ,eACRC,KAAM,6BACNC,YAAa,uCACbC,YAAa,QACbC,YAAa,SACbC,OAAQ,WACJC,GACJ,EACAC,OAAQ,WAER,GAGR,EACMD,EAAwB,WAE1B9C,EAAQW,OAAQ,EAEhBK,EAAgBgC,KAAK1B,MAAM,4BAA4B,CACnD2B,UAAW,WACPvC,IACAR,EAAcS,OAAQ,CAC1B,GAER,EAEMuC,GAAUjD,EAAAA,EAAAA,KAAI,MAEdkD,EAAe,WAEI,OAAlBD,EAAQvC,OAEc,IAAIyC,EAAAA,EAASF,EAAQvC,MAAO,CAC7C0C,IAAI/B,MAAM,6BACVgC,gBAAgB,EAChBC,gBAAe,EACfC,YAAY,GACZC,SAAS,EACTC,UAAU,OACVC,cAAe,QACfnC,QAAQ,CACJ,gBAAgBC,EAAAA,EAAAA,MAAUC,MAAMC,YAEpCiC,gBAAgB,EAChBf,OAAQ,SAASgB,EAAMC,GACF,WAAbD,EAAKE,KACLD,EAAK,oBAELA,GAER,IAIWE,GAAG,WAAW,SAAUH,EAAM7B,GACzC5B,EAAgBO,OAAQ,EACxBN,EAAaM,OAAQ,EACrBJ,EAASI,MAAQqB,EAASzB,SAAS,GAAG,GACtCD,EAAYK,MAAQqB,EAASiC,aAC7BrD,EAAUG,WAAaiB,EAASjB,UACpC,GAGR,E","sources":["webpack:///./resources/js/Pages/Product/UploadWorkshopExcelDropzone.vue?e626","webpack:///./resources/js/Pages/Product/UploadWorkshopExcelDropzone.vue"],"sourcesContent":["import script from \"./UploadWorkshopExcelDropzone.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./UploadWorkshopExcelDropzone.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    \n    <div>\n        <button type=\"button\" class=\"btn fw-bold btn-sm btn-light d-flex align-items-center\" @click=\"dialogVisible = true\"><i class=\"bi bi-box-arrow-in-right fs-4\"></i><span class=\"ms-1 lh-1\">IMPORT</span></button>\n\n        <Dialog v-model:visible=\"dialogVisible\" @hide=\"startOver\" modal header=\"Workshop dosyası yükle\" @show=\"makeDropzone\" :style=\"{ width: '50vw' }\" :breakpoints=\"{ '1200px': '75vw','960px': '85vw', '641px': '95vw' }\">\n\n            <div ref=\"dropRef\" class=\"dropzone\" v-show=\"dropzoneVisible\">\n                <div class=\"dz-message needsclick\">\n                    <i class=\"bi bi-cloud-arrow-up fs-3x text-primary\"></i>\n\n                    <div class=\"ms-4\">\n                        <h3 class=\"fs-5 fw-bold text-gray-900 mb-1\">Dosyayı buraya sürükleyin veya tıklayın.</h3>\n                        <span class=\"fs-7 fw-semibold text-gray-500\">Sadece xlsx dosyası</span>\n                    </div>\n                </div>\n            </div>\n\n            <div v-if=\"matchVisible && headings.length > 0\">\n                \n                <div class=\"hstack align-items-center justify-content-between\">\n                    <h4 class=\"mb-0\">Kolonları Eşleştir</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-light\" @click=\"startOver\">Geri</button>\n                </div>\n\n                <Divider />\n\n                <form class=\"table-responsive\" @submit.prevent=\"matchFormSubmit\">\n                    <table class=\"table align-middle table-row-bordered table-hover g-3\">\n                        <thead class=\"bg-light\">\n                            <tr class=\"fw-bold fs-6\">\n                                <th class=\"w-50 px-3\">Excel Başlık</th>\n                                <th class=\"w-50 px-3\">Değer</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr v-for=\"(head,index) in headings\" :key=\"index\">\n                                <td class=\"px-3 fw-semibold\">{{ head }}</td>\n                                <td class=\"px-3\">\n                                    <Dropdown v-model=\"matchForm.json_data[index]\" :options=\"matchFields\" filter optionValue=\"value\" optionLabel=\"label\" variant=\"filled\" size=\"small\" class=\"w-100\"/>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                    <Divider />\n                    <FormErrors :form=\"matchForm\" />\n                    <button type=\"submit\" class=\"btn btn-success\">ÖNİZLEME</button>\n                </form>\n\n            </div>\n\n        </Dialog>\n\n        <Dialog v-model:visible=\"previewVisible\" modal maximizable header=\"Önizleme & Kaydet\" :style=\"{ width: '95vw' }\">\n\n            <DataTable :value=\"startImportForm.json_data\" :rowClass=\"rowClass\" stripedRows tableStyle=\"min-width: 50rem\">\n                <template #empty> Seçilen kriterlere uygun kayıt bulunamadı. </template>\n                <Column header=\"Görsel\">\n                    <template #body=\"{ data }\">\n                        <img :src=\"data.image.preview_url\" width=\"50\" v-if=\"data.image\" class=\"rounded\"/>\n                    </template>\n                </Column>\n                <Column field=\"event_date\" header=\"Tarih\"></Column>\n                <Column header=\"Şube\">\n                    <template #body=\"{ data }\">\n                        <span v-if=\"data.team\">{{ data.team.name }}</span>\n                        <span class=\"badge badge-danger\" v-else>ŞUBE BULUNAMADI</span>\n                    </template>\n                </Column>\n                <Column header=\"Kategori\">\n                    <template #body=\"{ data }\">\n                        <span v-if=\"data.category\">{{ data.category.name }}</span>\n                        <span class=\"badge badge-danger\" v-else>KATEGORİ BULUNAMADI</span>\n                    </template>\n                </Column>\n                <Column field=\"name\" header=\"Etkinlik Adı\"></Column>\n            </DataTable>\n\n            <template #footer>\n                <button type=\"button\" class=\"btn btn-warning\" @click=\"previewVisible = false\">GERİ GÖN</button>\n                <button type=\"button\" class=\"btn btn-primary\" @click=\"startImportFormSubmitAlert\">KAYDET</button>\n            </template>\n\n        </Dialog>\n\n        <ConfirmDialog></ConfirmDialog>\n        <BlockUI :blocked=\"blocked\" fullScreen />\n\n    </div>\n\n</template>\n\n<script setup>\n\nimport {ref} from \"vue\";\nimport Dropzone from \"dropzone\";\nimport {usePage,useForm} from \"@inertiajs/vue3\";\nimport Dialog from \"primevue/dialog\";\nimport Divider from \"primevue/divider\";\nimport Dropdown from \"primevue/dropdown\";\nimport DataTable from \"primevue/datatable\";\nimport Column from 'primevue/column';\nimport { useConfirm } from \"primevue/useconfirm\";\nimport ConfirmDialog from \"primevue/confirmdialog\";\nimport BlockUI from 'primevue/blockui';\n\nconst props = defineProps({\n    uploadDone:{\n        type:Function,\n        required:false\n    }\n});\n\nconst blocked = ref(false);\nconst dialogVisible = ref(false);\nconst previewVisible = ref(false);\nconst dropzoneVisible = ref(true);\nconst matchVisible = ref(false);\nconst matchFields = ref([]);\nconst headings = ref([]);\n\nconst confirm = useConfirm();\n\nconst startOver = () => {\n    blocked.value = false;\n    dropzoneVisible.value = true;\n    previewVisible.value = false;\n    matchVisible.value = false;\n    headings.value = [];\n    matchFields.value = [];\n}\n\nconst matchForm = useForm({\n    json_data:[],\n    excel_uuid:\"\"\n});\n\nconst startImportForm = useForm({\n    json_data:[]\n});\n\nconst rowClass = (data) => {\n    return [{ 'bg-danger text-white': data.is_exists === true }];\n};\n\nconst matchFormSubmit = () => {\n\n    blocked.value = true;\n    startImportForm.json_data = [];\n    \n    fetch(route('mp.workshop.import.match'),{\n        method: 'POST',\n        headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json',\n            'X-CSRF-TOKEN': usePage().props.csrf_token\n        },\n        body: JSON.stringify({\n            json_data:matchForm.json_data,\n            excel_uuid:matchForm.excel_uuid\n        })\n    }).then(function (response) {\n        return response.json();\n    }).then((json) => {\n        blocked.value = false;\n        if( ! json.success ){\n            alert(json.message);\n            return;\n        }\n        startImportForm.json_data = json.review_items;\n        previewVisible.value = true;\n    });\n    \n}\n\nconst startImportFormSubmitAlert = () => {\n\n    confirm.require({\n        message: 'Tüm etkinliklerin eklenmesi zaman alabilir. Lütfen ekranı kapatmayın.',\n        header: 'Confirmation',\n        icon: 'pi pi-exclamation-triangle',\n        rejectClass: 'p-button-secondary p-button-outlined',\n        rejectLabel: 'İptal',\n        acceptLabel: 'Başlat',\n        accept: () => {\n            startImportFormSubmit()\n        },\n        reject: () => {\n            \n        }\n    });\n\n}\nconst startImportFormSubmit = () => {\n\n    blocked.value = true;\n\n    startImportForm.post(route('mp.workshop.import.store'),{\n        onSuccess: () => {\n            startOver();\n            dialogVisible.value = false;\n        },\n    });\n}\n\nconst dropRef = ref(null);\n\nconst makeDropzone = () => {\n\n    if(dropRef.value !== null) {\n\n        let uploadDropzone = new Dropzone(dropRef.value, {\n            url:route('mp.workshop.import.upload'),\n            parallelUploads:1,\n            uploadMultiple:false,\n            maxFilesize:50,\n            maxFiles:1,\n            paramName:'file',\n            acceptedFiles: '.xlsx',\n            headers:{\n                \"X-CSRF-TOKEN\": usePage().props.csrf_token\n            },\n            addRemoveLinks: true,\n            accept: function(file, done) {\n                if (file.name == \"wow.jpg\") {\n                    done(\"Naha, you don't.\");\n                } else {\n                    done();\n                }\n            },\n        });\n\n\n        uploadDropzone.on(\"success\", function (file, response) {\n            dropzoneVisible.value = false;\n            matchVisible.value = true;\n            headings.value = response.headings[0][0];\n            matchFields.value = response.match_fields;\n            matchForm.excel_uuid = response.excel_uuid;\n        });\n\n    }\n}\n\n</script>"],"names":["blocked","ref","dialogVisible","previewVisible","dropzoneVisible","matchVisible","matchFields","headings","confirm","useConfirm","startOver","value","matchForm","useForm","json_data","excel_uuid","startImportForm","rowClass","data","is_exists","matchFormSubmit","fetch","route","method","headers","usePage","props","csrf_token","body","JSON","stringify","then","response","json","success","review_items","alert","message","startImportFormSubmitAlert","require","header","icon","rejectClass","rejectLabel","acceptLabel","accept","startImportFormSubmit","reject","post","onSuccess","dropRef","makeDropzone","Dropzone","url","parallelUploads","uploadMultiple","maxFilesize","maxFiles","paramName","acceptedFiles","addRemoveLinks","file","done","name","on","match_fields"],"sourceRoot":""}